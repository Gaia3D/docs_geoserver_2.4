<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>GeoSearch &mdash; GeoServer 2.4.0 User Manual</title>
  <link rel="stylesheet" href="../_static/blueprint/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../_static/blueprint/print.css" type="text/css" media="print" /> 
  <!--[if IE]>
  <link rel="stylesheet" href="../_static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../_static/default.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.4.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/searchtools.js"></script>
  <script type="text/javascript" src="../searchindex.js"></script>
      <link rel="top" title="GeoServer 2.4.0 User Manual" href="../index.html" />
      <link rel="up" title="Extensions" href="index.html" />
      <link rel="next" title="Imagemap" href="imagemap.html" />
      <link rel="prev" title="Excel WFS Output Format" href="excel.html" />
</head>
<body class="extensions/geosearch">
  <div id="header" class="selfclear">
    <div class="wrap selfclear">
      <div id="logo"><a href="../index.html">GeoServer 2.4.0 User Manual</a></div>
      <ul id="top-nav">
        <li class="first"><a href="http://geoserver.org/display/GEOS/What+is+Geoserver">About</a></li>
        <li><a href="http://blog.geoserver.org/">Blog</a></li>
        <li><a href="http://geoserver.org/display/GEOS/Download">Download</a></li>
        <li><a href="../index.html">Documentation</a></li>
      </ul>
        <form id="quick-search" action="../search.html" method="get">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
            <input id="quick-search-submit" type="image" value="Search" src="../_static/chrome/search_icon_green.png" />
          </fieldset>
        </form>
    </div><!-- /.wrap -->
  </div><!-- /#header -->
  <div id="main">
    <div class="wrap selfclear">
      <div id="content">
<ul id="breadcrumbs">
  
  <li><a href="../index.html">GeoServer 2.4.0 User Manual</a> &raquo;</li>
  <li><a href="index.html" accesskey="U">Extensions</a> &raquo;</li>
  <li>GeoSearch</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="imagemap.html" title="Imagemap"
       accesskey="N">next</a></li>
  <li>
    <a href="excel.html" title="Excel WFS Output Format"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="geosearch">
<span id="geosearch-extension"></span><h1>GeoSearch<a class="headerlink" href="#geosearch" title="Permalink to this headline">¶</a></h1>
<div class="section" id="geosearch-indexing-module">
<h2>GeoSearch Indexing Module<a class="headerlink" href="#geosearch-indexing-module" title="Permalink to this headline">¶</a></h2>
<p>The GeoSearch indexing module adds support to GeoServer for exposing your data to Google&#8217;s GeoSearch. This makes it so more people can find your data, by searching directly on Google Maps or Google Earth. The format exposed is KML, so other search engines will also be able to crawl it when they are ready - Google is just the first to support it for sure. By default no data is published, but we highly encourage you to if your data can be publicly available, to help grow the wider geospatial web. Publishing is easy, as it is a part of the administration interface. For more information about geosearch see <a class="reference external" href="http://googlemapsapi.blogspot.com/2008/05/geo-search-20-data-in-data-out.html">this blog</a>.</p>
</div>
<div class="section" id="how-it-works">
<h2>How It Works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h2>
<p>The GeoSearch module adds a sitemap.xml endpoint in the GeoServer REST API; that is,
<a class="reference external" href="http://localhost:8080/geoserver/rest/sitemap.xml">http://localhost:8080/geoserver/rest/sitemap.xml</a> is your sitemap.  By submitting the sitemap through Google&#8217;s webmaster tools, you can get your map layers to show up in searches on <a class="reference external" href="http://maps.google.com/">http://maps.google.com/</a>.</p>
</div>
<div class="section" id="step-by-step">
<h2>Step By Step<a class="headerlink" href="#step-by-step" title="Permalink to this headline">¶</a></h2>
<p>A more explicit guide to using the GeoSearch module follows.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Load your data as normal.</li>
<li>Go to the Layer configuration page in GeoServer&#8217;s admin console for each layer you would like to expose, and check the &#8216;enable searching&#8217; checkbox on the <em>Publishing</em> tab.</li>
<li>Submit your sitemap.xml using Google&#8217;s webmaster tools. From your dashboard, pick the domain on which your server lives. In the menu on the left, click on &#8220;Sitemaps&#8221; and then &#8220;Add Sitemap&#8221;. You are adding a &#8220;General Web Sitemap&#8221;, and provide the URL equivalent <a class="reference external" href="http://localhost:8080/geoserver/rest/sitemap.xml">http://localhost:8080/geoserver/rest/sitemap.xml</a> .</li>
</ol>
</div></blockquote>
<p>The reason we are using &#8220;General Web Sitemap&#8221;, as opposed to a &#8220;Geo Sitemap&#8221;, is that sitemap.xml is really a sitemap index that links to a geo sitemap for each layer.</p>
</div>
<div class="section" id="behind-the-scenes">
<h2>Behind the Scenes<a class="headerlink" href="#behind-the-scenes" title="Permalink to this headline">¶</a></h2>
<p>GeoServer already has support for breaking up a dataset into regionated tiles. The information about what features belong in each tile is stored in an H2 database in $GEOSERVER_DATA_DIR/geosearch . We use this information when creating the sitemaps for Google. However, since the hierarchy may not be fully explored by the time a sitemap is submitted, the sitemaps also contain links to tiles deeper in the hierarchy, thereby expanding it. Some of these tiles may be empty, in which case Googlebot will receive a 204 response.</p>
</div>
<div class="section" id="big-datasets">
<h2>Big datasets<a class="headerlink" href="#big-datasets" title="Permalink to this headline">¶</a></h2>
<p>If you are making big datasets available, more than 50 000 individual features, up to 2,000,000, you should consider doing the following. The main burden is to sort the features according to an attribute, so that they are output in order of importance and included in exactly one tile.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Use a backend that supports queries, such as Postgis. You can use shp2psql to convert from a Shapefile to a SQL format supported by Postgis. Be sure to specify that you want a GIST (geospatial index) to be created, and provide the SRS. (-I and -s)</li>
<li>Make sure your database has a primary index (an auto-incrementing integer is fine) and a spatial index on the geometry column</li>
<li>Put an index on the column that you are going to sort the feature by. If you are using the size of the geometry, consider making an auxilliary column that contains the precalculated value and put an index on that. Note that GeoServer always sorts in descending order, so features you consider important should have a high value.</li>
<li>In GeoServer&#8217;s feature type configuration, be sure to use &#8220;native-sorting&#8221; for the regionating strategy, and your chosen column as the regionating attribute.</li>
<li>KML Feature Limit should generally be set to 50. It&#8217;s a balancing act between too much information per tile (Googlebot prefers document that are less than 1 megabyte) and a big hierarchy that takes long to build.</li>
</ol>
</div></blockquote>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="excel.html" title="previous chapter">Excel WFS Output Format</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="imagemap.html" title="next chapter">Imagemap</a></div>
      </div>
      </div><!-- /#content> -->
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">GeoSearch</a><ul>
<li><a class="reference internal" href="#geosearch-indexing-module">GeoSearch Indexing Module</a></li>
<li><a class="reference internal" href="#how-it-works">How It Works</a></li>
<li><a class="reference internal" href="#step-by-step">Step By Step</a></li>
<li><a class="reference internal" href="#behind-the-scenes">Behind the Scenes</a></li>
<li><a class="reference internal" href="#big-datasets">Big datasets</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="excel.html" title="previous chapter">Excel WFS Output Format</a></li>
            <li>Next: <a href="imagemap.html" title="next chapter">Imagemap</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
          <li><a href="../_sources/extensions/geosearch.txt">Show Source</a></li>
        </ul>
        </div>
  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div><!-- /#main -->
<div id="footer">
  <div class="wrap">
    &copy; Copyright 2013, OpenPlans. License <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution</a>.
    Last updated on Sep 18, 2013.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>